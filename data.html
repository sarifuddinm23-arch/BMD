<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Data Entry - BMD</title>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="config.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root { --primary: #f39c12; --dark: #1a1a1a; --bg: #f4f7f6; }
        body { font-family: 'Segoe UI', sans-serif; background: var(--bg); margin: 0; }
        .top-bar { background: var(--dark); color: white; padding: 15px; display: flex; justify-content: space-between; align-items: center; position: sticky; top:0; }
        .mode-btn { background: rgba(255,255,255,0.1); border: 1px solid rgba(255,255,255,0.3); color: white; padding: 5px 10px; border-radius: 15px; cursor: pointer; font-size: 12px; }
        
        .container { width: 95%; max-width: 420px; margin: 20px auto; transition: 0.4s; }
        .desktop-mode { max-width: 1100px !important; }

        .card { background: white; border-radius: 15px; padding: 20px; box-shadow: 0 5px 15px rgba(0,0,0,0.05); margin-bottom: 20px; }
        .card-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; border-bottom: 1px solid #eee; padding-bottom: 10px; }
        .add-btn { background: var(--primary); color: white; border: none; width: 35px; height: 35px; border-radius: 50%; cursor: pointer; display: flex; align-items: center; justify-content: center; }
        
        .data-list { list-style: none; padding: 0; margin: 0; max-height: 250px; overflow-y: auto; }
        .data-list li { padding: 12px; border-bottom: 1px solid #f8f9fa; font-size: 14px; display: flex; justify-content: space-between; }
        
        .grid-layout { display: grid; grid-template-columns: 1fr; gap: 20px; }
        .desktop-mode .grid-layout { grid-template-columns: 1fr 1fr 1fr; }
    </style>
</head>
<body>

<div class="top-bar">
    <div onclick="history.back()" style="cursor:pointer;"><i class="fas fa-arrow-left"></i> DATA ENTRY</div>
    <button class="mode-btn" onclick="toggleView()"><i class="fas fa-desktop"></i> Toggle View</button>
</div>

<div class="container" id="mainWrapper">
    <div class="grid-layout">
        
        <div class="card">
            <div class="card-header">
                <h3>Mother Category</h3>
                <button class="add-btn" onclick="addEntry('mother_categories')"><i class="fas fa-plus"></i></button>
            </div>
            <ul id="motherList" class="data-list"></ul>
        </div>

        <div class="card">
            <div class="card-header">
                <h3>Sub Category</h3>
                <button class="add-btn" onclick="addEntry('sub_categories')"><i class="fas fa-plus"></i></button>
            </div>
            <ul id="subList" class="data-list"></ul>
        </div>

        <div class="card">
            <div class="card-header">
                <h3>Product Name</h3>
                <button class="add-btn" onclick="addEntry('product_list')"><i class="fas fa-plus"></i></button>
            </div>
            <ul id="productList" class="data-list"></ul>
        </div>

    </div>
</div>

<script>
    function toggleView() {
        document.getElementById('mainWrapper').classList.toggle('desktop-mode');
    }

    // Generic Fetch Function
    async function fetchData(tableName, elementId) {
        const { data } = await supabaseClient.from(tableName).select('name').order('created_at', { ascending: false });
        const list = document.getElementById(elementId);
        list.innerHTML = '';
        if (data) {
            data.forEach(item => {
                list.innerHTML += `<li>${item.name} <i class="fas fa-check" style="color: #27ae60"></i></li>`;
            });
        }
    }

    // Generic Add Function (No Logic, Just Name)
    async function addEntry(tableName) {
        const val = prompt("Enter Name to Save:");
        if (!val) return;
        
        const { error } = await supabaseClient.from(tableName).insert([{ name: val }]);
        
        if (error) {
            alert("Error: " + error.message);
        } else {
            loadAll(); // Refresh Lists
        }
    }

    function loadAll() {
        fetchData('mother_categories', 'motherList');
        fetchData('sub_categories', 'subList');
        fetchData('product_list', 'productList');
    }

    window.onload = loadAll;
</script>
</body>
</html>
